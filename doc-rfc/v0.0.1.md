# Feature

- Feature Name:  `Authority Manager`
- Start Date: 2022-11-06

## Summary

A gRPC authority manager system.

## Motivation

We use this project to learn to implement a gRPC system, and to learn database migration and test, and to learn Jwt to
authorization.

## Guide-level explanation

### Service interface

```proto
message User{
  int32 id = 1;
  string name = 2;
  string email = 3;
  string password = 4;
  UserAuthLevel auth = 5;
  UserStatus status = 6;
}

enum UserAuthLevel{
  ADMIN,
  CUSTOMER
}

enum UserStatus{
  ACTIVE,
  FREEZE,
  DROPPED,
}

message CreateUserRequest{
  string name = 1;
  string email = 2;
  string password = 3;
}

message CreateUserResponse{
    int32 id = 1;
}
```

### Database schema

```postgresql
CREATE SCHEMA auth;
CREATE TYPE auth.user_auth_level AS ENUM ('admin', 'customer');
CREATE TYPE auth.user_status AS ENUM ('active', 'freeze', 'dropped');

CREATE TABLE auth.users
(
    id         SERIAL PRIMARY KEY,
    name       VARCHAR(255)    NOT NULL,
    email      VARCHAR(255)    Not Null,
    password   VARCHAR(255)    NOT NULL,
    auth_level auth.user_auth_level NOT NULL DEFAULT 'admin',
    status     auth.user_status     NOT NULL DEFAULT 'active'
)
```

## Unresolved questions

- Authority function.
- How to trace the interaction between services.
- How to migrate and test database.
- How to use front-end templates.
